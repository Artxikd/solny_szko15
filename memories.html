<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ù–∞—à–∏ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è</title>

<style>
body {
    margin: 0;
    padding: 0;
    font-family: 'Arial', sans-serif;
    background: linear-gradient(180deg, #0a1f3f, #1e3d7b, #4fa3ff);
    color: white;
    text-align: center;
    overflow-x: hidden;
    position: relative;
}

header {
    padding: 2rem 0;
}

header h1 {
    font-size: 2.5rem;
    margin: 0;
    letter-spacing: 2px;
}

/* –ì–∞–ª–µ—Ä–µ—è */
.gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 12px;
    max-width: 1400px;
    margin: 20px auto;
    padding: 0 10px;
}

.gallery-item {
    position: relative;
    background: rgba(255,255,255,0.15);
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    cursor: pointer;
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease, transform 0.6s ease;
}

.gallery-item.visible {
    opacity: 1;
    transform: translateY(0);
}

.gallery-item img,
.gallery-item video {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.gallery-item.video::after {
    content: '‚ñ∂';
    position: absolute;
    font-size: 3rem;
    color: rgba(255,255,255,0.8);
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none;
}

/* –õ–∞–π–∫–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ */
.like-btn, .comment-btn {
    position: absolute;
    bottom: 8px;
    font-size: 1.4rem;
    background: rgba(0,0,0,0.3);
    padding: 4px 8px;
    border-radius: 8px;
    color: white;
    cursor: pointer;
    user-select: none;
}
.like-btn { left: 8px; }
.comment-btn { right: 8px; }

/* –ú–æ–¥–∞–ª–∫–∞ */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.95);
    justify-content: center;
    align-items: center;
}

.modal-content {
    max-width: 90%;
    max-height: 90%;
    position: relative;
}

.modal-content img,
.modal-content video {
    width: 100%;
    height: auto;
}

.nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    font-size: 3rem;
    color: white;
    background: rgba(0,0,0,0.3);
    border: none;
    padding: 10px 20px;
    cursor: pointer;
    border-radius: 10px;
    user-select: none;
}
#prevBtn { left: 10px; }
#nextBtn { right: 10px; }

.modal-close {
    position: absolute;
    top: 20px;
    right: 20px;
    font-size: 2rem;
    color: white;
    cursor: pointer;
}

/* –ö–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ */
.back-btn {
    display: inline-block;
    margin: 20px 0;
    padding: 10px 18px;
    background: rgba(255,255,255,0.15);
    border: 2px solid rgba(255,255,255,0.3);
    border-radius: 12px;
    color: white;
    text-decoration: none;
    font-size: 16px;
    transition: 0.3s;
}
.back-btn:hover {
    background: rgba(255,255,255,0.25);
}

/* –°–µ–∑–æ–Ω–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã */
.falling {
    position: absolute;
    top: -30px;
    font-size: 20px;
    opacity: 0.8;
    pointer-events: none;
    animation: fall 8s linear infinite;
}
@keyframes fall {
    0% { transform: translateY(-30px) rotate(0deg); }
    100% { transform: translateY(110vh) rotate(360deg); }
}
</style>
</head>
<body>

<header>
    <h1>–ù–∞—à–∏ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è</h1>
</header>

<a href="index.html" class="back-btn">‚Üê –ì–ª–∞–≤–Ω–∞—è</a>

<div class="gallery" id="gallery"></div>

<div class="modal" id="modal">
    <span class="modal-close" id="modalClose">&times;</span>
    <button class="nav-btn" id="prevBtn">&#10094;</button>
    <div class="modal-content" id="modalContent"></div>
    <button class="nav-btn" id="nextBtn">&#10095;</button>
</div>

<script>
const gallery = document.getElementById('gallery');
const modal = document.getElementById('modal');
const modalContent = document.getElementById('modalContent');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
let mediaItems = [];
let currentIndex = 0;
const likes = []; // –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–∞–π–∫–æ–≤

// –ó–∞–≥—Ä—É–∑–∫–∞ JSON
fetch('data/media.json')
  .then(res => res.json())
  .then(items => {
    mediaItems = items;
    items.forEach((item,index)=>{
      likes[index] = 0;
      const wrapper = document.createElement('div');
      wrapper.className = 'gallery-item';
      if(item.type==='video') wrapper.classList.add('video');

      let media;
      if(item.type==='image'){
        media = document.createElement('img');
        media.src=item.src;
        media.loading='lazy';
      } else {
        media = document.createElement('video');
        media.src=item.src;
        media.poster=item.poster||'';
        media.muted=true;
        media.playsInline=true;
        media.preload='metadata';
      }

      wrapper.appendChild(media);

      // –õ–∞–π–∫ –∫–Ω–æ–ø–∫–∞
      const likeBtn = document.createElement('div');
      likeBtn.className = 'like-btn';
      likeBtn.textContent = `‚ù§Ô∏è ${likes[index]}`;
      likeBtn.onclick = e=>{
        e.stopPropagation();
        likes[index]++;
        likeBtn.textContent = `‚ù§Ô∏è ${likes[index]}`;
      }
      wrapper.appendChild(likeBtn);

      // –ö–æ–º–º–µ–Ω—Ç –∫–Ω–æ–ø–∫–∞
      const commentBtn = document.createElement('div');
      commentBtn.className = 'comment-btn';
      commentBtn.textContent = 'üí¨';
      commentBtn.onclick = e=>{
        e.stopPropagation();
        const comment = prompt('–û—Å—Ç–∞–≤—å—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:');
        if(comment) alert(`–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ${comment}`);
      }
      wrapper.appendChild(commentBtn);

      gallery.appendChild(wrapper);
      setTimeout(()=>wrapper.classList.add('visible'),index*80);
      wrapper.onclick = ()=>openModal(index);
    });
  })
  .catch(err=>console.error(err));

// –ú–æ–¥–∞–ª–∫–∞
function openModal(index){
  currentIndex=index;
  showModalContent();
  modal.style.display='flex';
}
function showModalContent(){
  modalContent.innerHTML='';
  const item=mediaItems[currentIndex];
  let clone;
  if(item.type==='image'){
    clone=document.createElement('img'); clone.src=item.src;
  } else {
    clone=document.createElement('video');
    clone.src=item.src;
    clone.poster=item.poster||'';
    clone.controls=true;
    clone.autoplay=true;
    clone.muted=false;
  }
  modalContent.appendChild(clone);
}

// –ù–∞–≤–∏–≥–∞—Ü–∏—è
prevBtn.onclick=()=>{currentIndex=(currentIndex-1+mediaItems.length)%mediaItems.length; showModalContent();}
nextBtn.onclick=()=>{currentIndex=(currentIndex+1)%mediaItems.length; showModalContent();}

// –ó–∞–∫—Ä—ã—Ç–∏–µ
document.getElementById('modalClose').onclick=()=>{
  const v=modalContent.querySelector('video');
  if(v)v.pause();
  modal.style.display='none';
  modalContent.innerHTML='';
};
modal.onclick=e=>{if(e.target===modal) document.getElementById('modalClose').onclick();}

// –°–≤–∞–π–ø—ã
let startX=0;
modalContent.addEventListener('touchstart',e=>startX=e.touches[0].clientX);
modalContent.addEventListener('touchend',e=>{
  let endX=e.changedTouches[0].clientX;
  if(endX-startX>50) prevBtn.onclick();
  else if(startX-endX>50) nextBtn.onclick();
});

// –°–µ–∑–æ–Ω–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
function spawnSeasonal(){
  const el=document.createElement('div');
  el.className='falling';
  const month=new Date().getMonth();
  if(month===11||month===0||month===1) el.textContent='‚ùÑ'; // –ó–∏–º–∞
  else if(month>=2&&month<=4) el.textContent='üå∏'; // –í–µ—Å–Ω–∞
  else if(month>=5&&month<=7) el.textContent='ü¶ã'; // –õ–µ—Ç–æ
  else el.textContent='üçÇ'; // –û—Å–µ–Ω—å
  el.style.left=Math.random()*window.innerWidth+'px';
  el.style.fontSize=(12+Math.random()*24)+'px';
  document.body.appendChild(el);
  setTimeout(()=>el.remove(),8000);
}
setInterval(spawnSeasonal,400); // –∫–∞–∂–¥—ã–µ 0.4 —Å–µ–∫—É–Ω–¥—ã
</script>

</body>
</html>
